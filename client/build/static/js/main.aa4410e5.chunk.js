(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],[,,,,,,,,function(e,t,a){e.exports=a(21)},,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(7),o=a.n(r),i=a(1),c=a(2),l=a(4),m=a(3),u=a(5),p=(a(13),a(14),a(15),function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(l.a)(this,Object(m.a)(t).call(this))).handleDelete=function(){fetch("/api/posts/".concat(e.props.postID),{method:"DELETE"}).then((function(){e.props.refresh()}))},e.handleFameClick=function(){e.setState({displayWidget:!e.state.displayWidget})},e.state={trackAlbumArtUrl:null,trackTitle:null,trackArtist:null,trackAlbum:null,displayWidget:!1},e}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("https://api.spotify.com/v1/tracks/".concat(this.props.song),{headers:{Authorization:"Bearer ".concat(this.props.token)}}).then((function(e){return e.json()})).then((function(t){e.setState({trackAlbumArtUrl:t.album.images[1].url,trackTitle:t.name,trackArtist:t.artists[0].name,trackAlbum:t.album.name})})).catch((function(t){console.log(t),e.setState({trackAlbumArtUrl:"/unknownTrack.jpg",trackTitle:"[unknown track]",trackArtist:"[unkown artist]",trackAlbum:"[unknown album]"})}))}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("div",{className:"post"},s.a.createElement("div",{className:"frame",onClick:this.handleFameClick},s.a.createElement("img",{src:this.state.trackAlbumArtUrl,alt:""})),s.a.createElement("div",{className:"info"},s.a.createElement("div",{className:"user-info"},s.a.createElement("h2",{className:"description"},this.props.description),s.a.createElement("p",{className:"username"},"Posted by ",this.props.UserName)),s.a.createElement("div",{className:"meta"},s.a.createElement("div",null,s.a.createElement("h2",null,this.state.trackTitle),s.a.createElement("h3",null,this.state.trackArtist," \u2022 ",this.state.trackAlbum))),s.a.createElement("div",{className:"buttons"},s.a.createElement("button",{className:"btn btn-secondary"},"View Comments"),this.props.UserID===this.props.currentUserID&&s.a.createElement("button",{className:"btn btn-danger",onClick:this.handleDelete},"DELETE")))),this.state.displayWidget&&s.a.createElement("iframe",{src:"https://open.spotify.com/embed/track/".concat(this.props.song),title:this.props.song,width:"100%",height:"80",frameBorder:"0",allowtransparency:"true",allow:"encrypted-media"}))}}]),t}(n.Component)),h=(a(16),a(17),function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"track",onClick:function(){return e.props.trackClick(e.props.id)}},s.a.createElement("div",{className:"frame"},s.a.createElement("img",{src:this.props.trackAlbumArtUrl,alt:this.props.trackTitle})),s.a.createElement("div",{className:"meta"},s.a.createElement("div",null,s.a.createElement("h2",null,this.props.trackTitle),s.a.createElement("h3",null,this.props.trackArtist," \u2022 ",this.props.trackAlbum))))}}]),t}(n.Component)),g=(a(18),function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(l.a)(this,Object(m.a)(t).call(this))).handleSubmit=function(t){t.preventDefault(),e.setState({results:[],postSong:"",postDescription:"",isMakingNew:!1}),fetch("/api/posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({PostDescription:t.target[1].value,PostSong:t.target[0].value,UserID:e.props.UserID})}).then((function(){e.props.refresh()})).catch((function(e){console.log(e)}))},e.handleOnChange=function(t){e.setState({postSong:t.target.value}),fetch("https://api.spotify.com/v1/search?q=".concat(t.target.value,"&type=track&market=US&limit=6"),{headers:{Authorization:"Bearer ".concat(e.props.token)}}).then((function(e){return e.json()})).then((function(t){e.setState({results:t.tracks.items})})).catch((function(t){console.log(t),e.setState({results:[]})}))},e.handleTrackClick=function(t){e.setState({results:[],postSong:t})},e.handleCreateNewPost=function(){e.setState({isMakingNew:!0})},e.handleCancel=function(){e.setState({results:[],postSong:"",postDescription:"",isMakingNew:!1})},e.state={results:[],postSong:"",postDescription:"",isMakingNew:!1},e}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",null,this.state.isMakingNew?s.a.createElement("form",{onSubmit:this.handleSubmit},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{className:"form-text text-muted",htmlFor:"PostSong"},"Enter Spotify Track ID"),s.a.createElement("input",{onChange:this.handleOnChange,value:this.state.postSong,className:"form-control",type:"text",name:"PostSong",id:"PostSong"})),s.a.createElement("div",null,this.state.results.map((function(t){return s.a.createElement(h,{key:t.id,trackClick:e.handleTrackClick,trackAlbumArtUrl:t.album.images[2].url,trackTitle:t.name,trackArtist:t.artists[0].name,trackAlbum:t.album.name,id:t.id})}))),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{className:"form-text text-muted",htmlFor:"PostDescription"},"Enter Description"),s.a.createElement("input",{onChange:function(t){return e.setState({postDescription:t.target.value})},value:this.state.postDescription,className:"form-control",type:"text",name:"PostDescription",id:"PostDescription"})),s.a.createElement("div",{className:"postOrCancel"},s.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.handleCancel},"Cancel"),s.a.createElement("input",{className:"btn btn-primary",type:"submit",value:"Post"}))):s.a.createElement("button",{onClick:this.handleCreateNewPost,className:"btn btn-primary"},"Create New Post"))}}]),t}(n.Component)),d=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(l.a)(this,Object(m.a)(t).call(this))).refreshPosts=function(){fetch("/api/posts/page/".concat(e.state.numPosts,"/").concat(e.state.pageNumber)).then((function(e){return e.json()})).then((function(t){return e.setState({posts:t},(function(){return console.log("".concat(e.state.numPosts," posts fetched on page ").concat(e.state.pageNumber),t)}))}))},e.handlePreviousPage=function(){if(e.state.pageNumber>0){var t=e.state.pageNumber-1;e.setState({pageNumber:t},(function(){e.refreshPosts()}))}},e.handleNextPage=function(){var t=e.state.pageNumber+1;e.setState({pageNumber:t},(function(){e.refreshPosts()}))},e.state={posts:[],token:null,numPosts:5,pageNumber:0},e}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.refreshPosts(),fetch("/api/token").then((function(e){return e.json()})).then((function(t){return e.setState({token:t.access_token})}))}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"posts-section"},s.a.createElement("h1",null,"Posts"),this.props.isLoggedIn&&s.a.createElement(g,{refresh:this.refreshPosts,token:this.state.token,UserID:this.props.UserID}),s.a.createElement("div",{className:"posts-container"},this.state.posts.map((function(t){return s.a.createElement(p,{key:t.PostID,postID:t.PostID,refresh:e.refreshPosts,description:t.PostDescription,song:t.PostSong,UserID:t.UserID,UserName:t.UserName,currentUserID:e.props.UserID,token:e.state.token})}))),s.a.createElement("div",{className:"pageNav"},s.a.createElement("button",{className:"btn btn-secondary",onClick:this.handlePreviousPage},"Previous Page"),s.a.createElement("h4",null,"page ",this.state.pageNumber+1),s.a.createElement("button",{className:"btn btn-secondary",onClick:this.handleNextPage},"Next Page")))}}]),t}(n.Component),b=(a(19),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(s)))).state={},a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"navbar"},s.a.createElement("div",{className:"container"},s.a.createElement("img",{className:"logo",src:"/logowordmark.svg",alt:"our songs logo"}),s.a.createElement("div",{className:"logged"},this.props.isLoggedIn?s.a.createElement("div",{className:"logged-in"},s.a.createElement("h3",null,this.props.Username),s.a.createElement("button",{className:"btn btn-secondary",onClick:this.props.handleLogOut},"Log Out")):s.a.createElement("div",{className:"logged-out"},s.a.createElement("button",{className:"btn btn-secondary",onClick:this.props.handleLogInOpenClose},"Login"),s.a.createElement("button",{className:"btn btn-secondary",onClick:this.props.handleSignUpOpenClose},"Sign Up")))))}}]),t}(n.Component)),f=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(l.a)(this,Object(m.a)(t).call(this))).state={comments:[]},e}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"comments-section"},s.a.createElement("h1",null,"Comments"))}}]),t}(n.Component),E=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(l.a)(this,Object(m.a)(t).call(this))).handleOnChange=function(){e.setState({isBadLogIn:!1,badLogInMessage:""})},e.handleSubmit=function(t){t.preventDefault(),fetch("/api/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({UserName:t.target[0].value,Password:t.target[1].value})}).then((function(t){return 200===t.status?t.json():(e.setState({isBadLogIn:!0,badLogInMessage:"Incorrect Login"}),Promise.reject())})).then((function(t){e.props.handleLogIn(t[0].UserID,t[0].Username)})).catch((function(e){console.log(e)}))},e.state={isBadLogIn:!1,badLogInMessage:""},e}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"log-in"},s.a.createElement("h2",null,"Log In"),s.a.createElement("form",{onSubmit:this.handleSubmit},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{className:"form-text text-muted",htmlFor:"username"},"Enter Username"),s.a.createElement("input",{onChange:this.handleOnChange,className:"form-control",type:"text",name:"username",placeholder:"Username",id:"username"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{className:"form-text text-muted",htmlFor:"password"},"Enter Password"),s.a.createElement("input",{onChange:this.handleOnChange,className:"form-control",type:"password",name:"password",placeholder:"Password",id:"password"})),this.state.isBadLogIn&&s.a.createElement("label",{className:"form-text text-warning",htmlFor:"username"},this.state.badLogInMessage),s.a.createElement("div",{className:"postOrCancel"},s.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.props.handleLogInOpenClose},"Cancel"),s.a.createElement("input",{className:"btn btn-primary",type:"submit",value:"Submit"}))))}}]),t}(n.Component),k=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(l.a)(this,Object(m.a)(t).call(this))).handleSubmit=function(t){t.preventDefault(),fetch("/api/users/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({UserName:t.target[0].value,Password:t.target[1].value})}).then((function(t){return 200===t.status?t.json():(e.setState({isBadSignUp:!0,badSignUpMessage:"Username Taken"}),Promise.reject())})).then((function(t){e.props.handleSignUp(t.UserName)})).catch((function(e){console.log(e)}))},e.state={isBadSignUp:!1,badSignUpMessage:""},e}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"log-in"},s.a.createElement("h2",null,"Sign Up"),s.a.createElement("form",{onSubmit:this.handleSubmit},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{className:"form-text text-muted",htmlFor:"username"},"Enter Username"),s.a.createElement("input",{className:"form-control",type:"text",name:"username",placeholder:"Username",id:"username"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{className:"form-text text-muted",htmlFor:"password"},"Enter Password"),s.a.createElement("input",{className:"form-control",type:"password",name:"password",placeholder:"Password",id:"password"})),this.state.isBadSignUp&&s.a.createElement("label",{className:"form-text text-warning",htmlFor:"username"},this.state.badSignUpMessage),s.a.createElement("div",{className:"postOrCancel"},s.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.props.handleSignUpOpenClose},"Cancel"),s.a.createElement("input",{className:"btn btn-primary",type:"submit",value:"Submit"}))))}}]),t}(n.Component),N=(a(20),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(l.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(s)))).state={},a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"welcome"},s.a.createElement("div",{className:"container"},s.a.createElement("img",{src:"/icon.svg",alt:"our songs logo"}),s.a.createElement("h1",null,"Welcome, ",this.props.UserName),s.a.createElement("p",null,"Log in to make posts and comments."),s.a.createElement("button",{className:"btn btn-primary",onClick:this.props.handleWelcomeGoBack},"Return to OurSongs")))}}]),t}(n.Component)),v=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(l.a)(this,Object(m.a)(t).call(this))).handleSignUpOpenClose=function(){e.setState({isSigningUp:!e.state.isSigningUp,isViewingPosts:!e.state.isViewingPosts&&!e.state.isLoggingIn,isLoggingIn:!1})},e.handleSignUp=function(t){e.setState({Username:t,isWelcoming:!0}),e.handleSignUpOpenClose()},e.handleWelcomeGoBack=function(){e.setState({isWelcoming:!1,Username:""},e.handleLogInOpenClose())},e.handleLogIn=function(t,a){e.setState({UserID:t,Username:a,isLoggedIn:!0,isViewingPosts:!0,isLoggingIn:!1})},e.handleLogOut=function(){e.setState({isLoggedIn:!1,UserID:-1})},e.handleLogInOpenClose=function(){e.setState({isLoggingIn:!e.state.isLoggingIn,isViewingPosts:!e.state.isViewingPosts&&!e.state.isSigningUp,isSigningUp:!1})},e.state={isLoggedIn:!1,UserID:-1,Username:"",isWelcoming:!1,isSigningUp:!1,isLoggingIn:!1,isViewingPosts:!0,isViewingComments:!1},e}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"App"},this.state.isWelcoming&&s.a.createElement(N,{UserName:this.state.Username,handleWelcomeGoBack:this.handleWelcomeGoBack}),s.a.createElement(b,{Username:this.state.Username,isLoggedIn:this.state.isLoggedIn,handleSignUpOpenClose:this.handleSignUpOpenClose,handleLogInOpenClose:this.handleLogInOpenClose,handleLogOut:this.handleLogOut}),s.a.createElement("div",{className:"container"},this.state.isSigningUp&&s.a.createElement(k,{handleSignUpOpenClose:this.handleSignUpOpenClose,handleSignUp:this.handleSignUp}),this.state.isLoggingIn&&s.a.createElement(E,{handleLogInOpenClose:this.handleLogInOpenClose,handleLogIn:this.handleLogIn}),this.state.isViewingComments&&s.a.createElement(f,null),this.state.isViewingPosts&&s.a.createElement(d,{isLoggedIn:this.state.isLoggedIn,UserID:this.state.UserID,UserName:this.state.UserName})))}}]),t}(n.Component);o.a.render(s.a.createElement(v,null),document.getElementById("root"))}],[[8,1,2]]]);
//# sourceMappingURL=main.aa4410e5.chunk.js.map